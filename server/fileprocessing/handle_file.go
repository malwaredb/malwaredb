package fileprocessing

import (
	"bytes"
	"github.com/rjzak/MalwareDB/server/utils"
)

func FileTypeIDFromBytes(fileContents []byte, config *utils.ServerConfigFile) (int, error) {
	rows, err := config.DbDriver.Query("select id, magic from filetype")
	if err != nil {
		return -1, err
	}

	var fileTypeID int = -1
	for rows.Next() {
		var magic [][]byte
		rows.Scan(&fileTypeID, magic)

		for _, magicNum := range magic {
			if bytes.HasPrefix(fileContents, magicNum) {
				break
			}
		}
	}
	rows.Close()
	return fileTypeID, nil
}

func HandleFileSubmission(fileName string, fileContents []byte, fileType int, userID int, config *utils.ServerConfigFile) {

}