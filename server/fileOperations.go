package main

import (
	"crypto/md5"
	"fmt"
	"crypto/sha1"
	"crypto/sha256"
	"crypto/sha512"
	"encoding/base64"
	"github.com/malwaredb/golzjd"
	"github.com/rjzak/MalwareDB/mdbcommon"
	"github.com/rjzak/MalwareDB/server/db"

)

func AddFile(sample mdbcommon.NewSample, connection db.DBConnection) error {
	fileBytes, err := base64.StdEncoding.DecodeString(sample.FileContentsBase64)
	if err != nil {
		return err
	}
	md5Hash := fmt.Sprintf("%x", md5.Sum(fileBytes))
	sha1Hash := fmt.Sprintf("%x", sha1.Sum(fileBytes))
	sha256Hash := fmt.Sprintf("%x", sha256.Sum256(fileBytes))
	sha512Hash := fmt.Sprintf("%x", sha512.Sum512(fileBytes))
	lzjdHash := golzjd.GenerateHashFromBuffer(fileBytes)
}